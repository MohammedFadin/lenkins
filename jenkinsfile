pipeline {
    def currentBuild
    agent any

    retry(3) {
        stages{
                    stage('Checkout') {
            checkout scm
        }
    currentBuild = "SUCCESS"
    stage('Test') {
        steps{
        env.NODE_ENV = "test"
        print "Running Environment is: ${env.NODE_ENV}"

        sh 'node -v'
        sh 'npm prune'
        sh 'npm i'
        sh 'npm test'
        }
    }
        }
    } catch (error) {
        currentBuild = "FAILURE"

        print "There is an error"
        throw error
    }
}