pipeline {
    def currentBuild.result
    agent any
    currentBuild.result = "SUCCESS"

    try {
        stage('Checkout') {
            checkout scm
        }

    stage('Test') {
        steps{
        env.NODE_ENV = "test"
        print "Running Environment is: ${env.NODE_ENV}"

        sh 'node -v'
        sh 'npm prune'
        sh 'npm i'
        sh 'npm test'
        }
    }
    } catch (error) {
        currentBuild.result = "FAILURE"

        print "There is an error"
        throw error
    }
}